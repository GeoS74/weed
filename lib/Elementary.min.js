"use strict"
function Detector(){this.observers=[];this.value=null;this.then=[];Object.defineProperties(this,{observers:{enumerable:!1},value:{enumerable:!1},then:{enumerable:!1},})}
Detector.prototype.attach=function(observer){this.observers.push(observer);return this};Detector.prototype.detach=function(observer){for(let i=0;i<this.observers.length;i++){if(this.observers[i]==observer){this.observers[i]=null;break}}
return this};Detector.prototype.setVal=function(value){let promise=new Promise(function(resolve,reject){this.value=value;this.notify();resolve()}.bind(this));if(this.then.length)for(let i=0;i<this.then.length;i++)promise.then(this.then[i]);return this}
Detector.prototype.setThen=function(func){this.then.push(func);return this}
Detector.prototype.getVal=function(){return this.value};Detector.prototype.notify=function(){for(let i=0;i<this.observers.length;i++)if(this.observers[i]!==null)this.observers[i].update();};Object.defineProperties(Detector.prototype,{attach:{enumerable:!1},detach:{enumerable:!1},setVal:{enumerable:!1},getVal:{enumerable:!1},notify:{enumerable:!1},setThen:{enumerable:!1},});function Observer(model){this.model=model;this.model.attach(this);Object.defineProperty(this,'model',{enumerable:!1})}
Observer.prototype.update=function(){};Object.defineProperty(Observer.prototype,'update',{enumerable:!1});function Backend(){Detector.call(this);this.backend={path:'',data:{}};Object.defineProperty(this,'backend',{enumerable:!1})}
Backend.prototype=Object.create(Detector.prototype);Backend.prototype.constructor=Backend;Backend.prototype.setPath=function(path){this.backend.path=path;return this};Backend.prototype.setData=function(data){this.backend.data=data;return this};Backend.prototype.query=function(){GsHttpRequest.query(this.backend.path,this.backend.data,function(result,errors){if(errors){console.log(errors)}
this.setVal(result)}.bind(this),!0);return this};Object.defineProperties(Backend.prototype,{constructor:{enumerable:!1},setPath:{enumerable:!1},setData:{enumerable:!1},query:{enumerable:!1},});function Unit(model){Backend.call(this);Observer.call(this,(model||this));this.update=this.handler();Object.defineProperty(this,'update',{enumerable:!1})}
Unit.prototype=Object.create(Backend.prototype);Unit.prototype.constructor=Unit;Unit.prototype.update=function(){};Unit.prototype.handler=function(){return this.update};Unit.prototype.setHandler=function(func){if(typeof func=='function')this.update=func;return this};Object.defineProperties(Unit.prototype,{constructor:{enumerable:!1},update:{enumerable:!1},handler:{enumerable:!1},setHandler:{enumerable:!1},});function El(html,model){this.parentNode=document.body;this.elem=null;this.error;if(html)this.create(html);Unit.call(this,model);return this}
El.prototype=Object.create(Unit.prototype);El.prototype.constructor=El;El.prototype.setParentNode=function(parentNode){this.parentNode=parentNode;return this};El.prototype.html=function(html){if(html)this.create(html);return this.elem.outerHTML};El.prototype.render=function(type,html){if(html){this.elem.insertAdjacentHTML((type||'afterend'),html)}else{this.parentNode.insertAdjacentElement((type||'beforeend'),this.elem)}
return this};El.prototype.create=function(html){let div=document.createElement('div');div.insertAdjacentHTML('afterbegin',html);this.elem=div.firstElementChild;return this};El.prototype.error=function(error){if(error){this.error=error}else{console.log(error.name);console.log(error.message)}};El.prototype.on=function(event,handler){this.elem.addEventListener(event,handler);return this};El.prototype.off=function(event){};El.prototype.wrap=function(html){let div=document.createElement('div');div.insertAdjacentHTML('afterbegin',html);this.elem.after(div.firstElementChild);this.elem.nextElementSibling.append(this.elem);return this};Object.defineProperties(El.prototype,{constructor:{enumerable:!1},setParentNode:{enumerable:!1},render:{enumerable:!1},create:{enumerable:!1},error:{enumerable:!1},on:{enumerable:!1},wrap:{enumerable:!1},html:{enumerable:!1},});function Elem(e,model){this.targetNode;this.elem;this.parentNode=document.body;if(e)this.create(e);this.error;Unit.call(this,model);Object.defineProperties(this,{targetNode:{enumerable:!1},elem:{enumerable:!1},parentNode:{enumerable:!1},error:{enumerable:!1},})}
Elem.prototype=Object.create(Unit.prototype);Elem.prototype.constructor=Elem;Elem.prototype.setParentNode=function(parentNode){this.parentNode=parentNode;return this};Elem.prototype.render=function(){this.parentNode.prepend(this.elem);return this};Elem.prototype.create=function(HTML_tag){try
{this.elem=document.createElement(HTML_tag)}catch(error){this.error(error)}
return this};Elem.prototype.error=function(error){if(error){this.error=error}else{console.log(error.name);console.log(error.message)}};Object.defineProperties(Elem.prototype,{constructor:{enumerable:!1},setParentNode:{enumerable:!1},render:{enumerable:!1},create:{enumerable:!1},error:{enumerable:!1},})